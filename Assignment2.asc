Version 4
SHEET 1 4884 1040
WIRE 3744 -320 3728 -320
WIRE 3776 -320 3744 -320
WIRE 3888 -320 3856 -320
WIRE 4080 -320 4064 -320
WIRE 4096 -320 4080 -320
WIRE 4240 -320 4176 -320
WIRE 3008 -256 2880 -256
WIRE 3168 -256 3072 -256
WIRE 2880 -160 2880 -256
WIRE 2992 -160 2880 -160
WIRE 3168 -160 3168 -256
WIRE 3168 -160 3072 -160
WIRE 3232 -160 3168 -160
WIRE 3744 -128 3744 -320
WIRE 3792 -128 3744 -128
WIRE 4080 -128 4080 -320
WIRE 4112 -128 4080 -128
WIRE 3888 -112 3888 -320
WIRE 3888 -112 3856 -112
WIRE 4240 -112 4240 -320
WIRE 4240 -112 4176 -112
WIRE 4288 -112 4240 -112
WIRE 3648 -96 3552 -96
WIRE 3792 -96 3648 -96
WIRE 3888 -96 3888 -112
WIRE 4112 -96 3888 -96
WIRE 3648 -48 3648 -96
WIRE 2720 -16 2560 -16
WIRE 2880 -16 2880 -160
WIRE 2880 -16 2720 -16
WIRE 2960 -16 2880 -16
WIRE 3168 0 3168 -160
WIRE 3168 0 3024 0
WIRE 2960 16 2928 16
WIRE 2928 64 2928 16
WIRE 3024 64 2928 64
WIRE 2560 80 2560 -16
WIRE 2720 80 2720 -16
WIRE 2880 80 2880 -16
WIRE 3648 80 3648 32
WIRE -176 96 -208 96
WIRE 3024 96 3024 64
WIRE 1344 144 1184 144
WIRE 1184 240 1184 144
WIRE 1344 240 1344 144
WIRE 2560 240 2560 160
WIRE 2720 240 2720 144
WIRE 2720 240 2560 240
WIRE 2880 240 2880 160
WIRE 2880 240 2720 240
WIRE 2720 320 2720 240
WIRE 1184 400 1184 320
WIRE 1248 400 1184 400
WIRE 1344 400 1344 304
WIRE 1344 400 1248 400
FLAG -160 576 0
FLAG -160 496 Vin
FLAG -208 96 Vin
FLAG 2720 320 0
FLAG 2608 672 0
FLAG 2992 32 0
FLAG 2464 672 0
FLAG 1248 400 0
FLAG 2464 592 Vsupply
FLAG 2992 -32 Vsupply
FLAG 3824 -80 0
FLAG 4144 -80 0
FLAG 4144 -144 Vsupply
FLAG 3824 -144 Vsupply
FLAG 2608 592 Vbias
FLAG 3024 96 Vbias
FLAG 3648 80 Vbias
FLAG 3648 -320 Vbias
FLAG 3984 -320 Vbias
FLAG 3232 -160 Vdet
FLAG 3488 -96 Vdet
FLAG 4288 -112 Vamp
SYMBOL voltage -160 480 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V3
SYMATTR Value SINE({Vin_offset} {A} {f})
SYMBOL LED 1328 240 R0
SYMATTR InstName D1
SYMATTR Value KA3529
SYMBOL bi 2560 80 R0
WINDOW 3 -541 40 Left 2
SYMATTR Value I=9.55e-6*I(D1)+15e-8*white(1e8*time)
SYMATTR InstName I_P
SYMBOL cap 2704 80 R0
WINDOW 3 24 36 Left 2
SYMATTR Value 4.25p
SYMATTR InstName C_0
SYMBOL res 2864 64 R0
WINDOW 3 36 68 Left 2
SYMATTR Value 16.6G
SYMATTR InstName R_leak
SYMBOL cap 3072 -272 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C1
SYMATTR Value 7.5p
SYMBOL res 3088 -176 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R1
SYMATTR Value 100k
SYMBOL voltage 2608 576 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V1
SYMATTR Value 2.5
SYMBOL current 1184 320 R180
WINDOW 0 24 80 Left 2
WINDOW 3 24 0 Left 2
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName I1
SYMATTR Value PULSE(100mA 0 0 0 0 12.5u 25u)
SYMBOL voltage 2464 576 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V2
SYMATTR Value 5
SYMBOL OpAmps\\opamp2 2256 -640 R0
SYMATTR InstName U1
SYMATTR Value LM358
SYMBOL cap 3552 -112 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C2
SYMATTR Value 100n
SYMBOL res 3632 -64 R0
SYMATTR InstName R2
SYMATTR Value 1k
SYMBOL res 3872 -336 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R3
SYMATTR Value 17.5k
SYMBOL res 3744 -336 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R4
SYMATTR Value 20k
SYMBOL res 4192 -336 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R5
SYMATTR Value 10k
SYMBOL res 4080 -336 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R6
SYMATTR Value 20k
SYMBOL OpAmps\\opamp2 2992 -64 R0
SYMATTR InstName U2
SYMATTR Value LM358
SYMBOL OpAmps\\opamp2 3824 -176 R0
SYMATTR InstName U3
SYMATTR Value LM358
SYMBOL OpAmps\\opamp2 4144 -176 R0
SYMATTR InstName U4
SYMATTR Value LM358
TEXT 400 464 Left 2 !.tran 0 1.5m 1m startup
TEXT 408 552 Left 2 !.param f=2.5k Vin_offset=3V A=1
TEXT 408 632 Left 2 !.include "KA3529 LTSpice Model.txt"
TEXT 2560 -40 Left 2 ;Photo-diode
TEXT 408 528 Left 2 ;For this param, change f between 1-2.5k, Vin_offset keep between 2-3V, and keep A low (around 1V)
TEXT 3664 528 Left 2 ;Example SPICE directive for obtaining harmonic components\n.fourier {f} 100 V(vout)
TEXT 2736 536 Left 2 ;Photo-diode\nWhen the transmitter and receiver are 100mm apart use the equation\nI=9.5e-6*I(D1)+15e-9*white(1e8*time)\n \nWhen the transmitter and receiver are 400mm apart use the equation\nI=0.55e-6*I(D1)+15e-9*white(1e8*time)
TEXT 464 104 Left 7 ;Transmitter
TEXT 3152 800 Left 7 ;Receiver
TEXT 416 688 Left 2 ;.include LM393A.5_1
TEXT 432 728 Left 2 !.include eee305.lib
TEXT 2752 720 Left 2 !.fourier {f} 100 V(vout)
TEXT 3072 -216 Left 2 ;15//15
LINE Normal 1504 -368 1504 976 2
LINE Normal -512 -368 1504 -368 2
LINE Normal -512 992 -512 -368 2
LINE Normal 1504 992 -512 992 2
