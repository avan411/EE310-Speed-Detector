Version 4
SHEET 1 4884 1384
WIRE 352 -224 -320 -224
WIRE -688 -176 -720 -176
WIRE -656 -176 -688 -176
WIRE -560 -176 -576 -176
WIRE -128 -160 -192 -160
WIRE -16 -160 -64 -160
WIRE -560 -80 -560 -176
WIRE -320 -32 -320 -224
WIRE -288 -32 -320 -32
WIRE -192 -32 -192 -160
WIRE -192 -32 -208 -32
WIRE -688 -16 -688 -176
WIRE -656 -16 -688 -16
WIRE 192 -16 128 -16
WIRE -560 0 -560 -80
WIRE -560 0 -592 0
WIRE -192 0 -192 -32
WIRE -176 0 -192 0
WIRE 352 0 352 -224
WIRE 352 0 256 0
WIRE -1088 16 -1120 16
WIRE -960 16 -1024 16
WIRE -848 16 -960 16
WIRE -688 16 -768 16
WIRE -656 16 -688 16
WIRE -16 16 -16 -160
WIRE -16 16 -112 16
WIRE 16 16 -16 16
WIRE 160 16 96 16
WIRE 192 16 160 16
WIRE -176 32 -288 32
WIRE -1120 48 -1120 16
WIRE -960 48 -960 16
WIRE 160 128 160 16
WIRE 208 128 160 128
WIRE 352 128 352 0
WIRE 352 128 288 128
WIRE 720 416 496 416
WIRE 944 416 720 416
WIRE 944 464 944 416
WIRE 496 480 496 416
WIRE -576 528 -672 528
WIRE 720 608 720 416
WIRE 16 656 16 624
WIRE 496 656 496 560
WIRE 656 656 496 656
WIRE -112 752 -464 752
WIRE 944 752 944 528
WIRE 16 768 16 736
WIRE 16 768 -48 768
WIRE 80 768 16 768
WIRE -320 784 -352 784
WIRE -224 784 -240 784
WIRE -112 784 -224 784
WIRE 496 800 496 656
WIRE 720 800 720 704
WIRE 880 800 720 800
WIRE 720 880 720 800
WIRE 944 880 944 848
WIRE -224 912 -224 784
WIRE -144 912 -224 912
WIRE 16 912 16 768
WIRE 16 912 -64 912
WIRE 496 976 496 880
WIRE 720 976 720 960
WIRE 720 976 496 976
WIRE 720 992 720 976
WIRE 944 992 944 960
WIRE 944 992 720 992
FLAG -1136 560 0
FLAG -1136 480 Vsupply
FLAG -16 16 Vtri
FLAG 224 32 0
FLAG -144 48 0
FLAG -288 32 Vref
FLAG 128 -16 Vref
FLAG 352 0 Vsq
FLAG -144 -16 Vsupply
FLAG 224 -32 Vsupply
FLAG -928 480 Vref
FLAG -928 560 0
FLAG 432 -224 Vsupply
FLAG -672 608 0
FLAG -672 448 Vsupply
FLAG -800 -176 0
FLAG -688 96 Vref
FLAG -624 32 0
FLAG -1120 128 0
FLAG -624 -32 Vsupply
FLAG -960 128 0
FLAG -80 736 Vsupply
FLAG -80 800 0
FLAG -560 -80 Vinput_conditioned
FLAG -464 752 Vtri
FLAG 16 624 Vsupply
FLAG -352 864 0
FLAG 80 768 Vpwm
FLAG 720 416 Vsupply
FLAG 496 656 Vpwm
FLAG 720 992 0
SYMBOL voltage -1136 464 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V1
SYMATTR Value {Vsupply}
SYMBOL res -192 -48 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R1
SYMATTR Value {R1}
SYMBOL cap -64 -176 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C1
SYMATTR Value {C1}
SYMATTR SpiceLine Rser=10m
SYMBOL res 112 0 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R2
SYMATTR Value {R2}
SYMBOL res 304 112 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R3
SYMATTR Value {R3}
SYMBOL voltage -928 464 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V2
SYMATTR Value {Vref}
SYMBOL res 448 -240 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R4
SYMATTR Value 1k
SYMBOL res -688 432 R0
SYMATTR InstName R6
SYMATTR Value 1k
SYMBOL res -688 512 R0
SYMATTR InstName R7
SYMATTR Value 1k
SYMBOL res -752 0 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R10
SYMATTR Value 150k
SYMBOL res -672 112 R180
WINDOW 0 36 76 Left 2
WINDOW 3 36 40 Left 2
SYMATTR InstName R12
SYMATTR Value 100k
SYMBOL res -672 -160 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 0 56 VBottom 2
SYMATTR InstName R13
SYMATTR Value 100k
SYMBOL res -816 -160 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 0 56 VBottom 2
SYMATTR InstName R14
SYMATTR Value 150k
SYMBOL voltage -1120 32 R0
WINDOW 0 -115 54 Left 2
WINDOW 3 -114 187 Left 2
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName Vinput
SYMATTR Value SINE({Vinput_offset} 1 {Vinput_frequency})
SYMBOL cap -1024 0 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C2
SYMATTR Value 1µ
SYMBOL res -976 32 R0
SYMATTR InstName R5
SYMATTR Value 8.5k
SYMBOL res -48 896 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R8
SYMATTR Value 22k
SYMBOL res -224 768 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R9
SYMATTR Value 100
SYMBOL res 0 640 R0
SYMATTR InstName R11
SYMATTR Value 1k
SYMBOL voltage -352 768 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V3
SYMATTR Value SINE(1.75 0.5 2.5k)
SYMBOL OpAmps\\opamp2 -624 -64 R0
SYMATTR InstName U1
SYMATTR Value LM358
SYMBOL OpAmps\\opamp2 -144 -48 R0
SYMATTR InstName U2
SYMATTR Value LM358
SYMBOL OpAmps\\opamp2 224 -64 R0
SYMATTR InstName U3
SYMATTR Value LM393A
SYMBOL OpAmps\\opamp2 -80 704 R0
SYMATTR InstName U4
SYMATTR Value LM393A
SYMBOL npn 656 608 R0
SYMATTR InstName Q1
SYMATTR Value BC547B
SYMBOL npn 880 752 R0
SYMATTR InstName Q2
SYMATTR Value BC639
SYMBOL res 480 464 R0
SYMATTR InstName R15
SYMATTR Value 2k
SYMBOL res 480 784 R0
SYMATTR InstName R16
SYMATTR Value 1k
SYMBOL res 704 864 R0
SYMATTR InstName R17
SYMATTR Value 1k
SYMBOL res 928 864 R0
SYMATTR InstName R18
SYMATTR Value 16
SYMBOL LED 928 464 R0
SYMATTR InstName D1
SYMATTR Value KA3529
TEXT -1176 1144 Left 2 !.param C1=15n Vref=1.75 Vsupply=5 R1=1k R2=33k R3=82k
TEXT -1176 1192 Left 2 !.include LM393A.5_1
TEXT -1176 1064 Left 2 !.param Vinput_frequency=2.5k Vinput_offset=1
TEXT -1168 1264 Left 2 !.include BC639_LTSpice_Model.txt
TEXT -1168 1304 Left 2 !.include KA3529_LTSpice_Model.txt
TEXT -1160 1368 Left 2 !.tran 0 10.6m 10m
TEXT -1136 984 Left 2 !.include eee305.lib
