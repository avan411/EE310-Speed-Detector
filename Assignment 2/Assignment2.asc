Version 4
SHEET 1 6008 2120
WIRE 1600 -816 848 -816
WIRE 1040 -752 976 -752
WIRE 1152 -752 1104 -752
WIRE 336 -736 304 -736
WIRE 368 -736 336 -736
WIRE 464 -736 448 -736
WIRE 464 -656 464 -736
WIRE 528 -656 464 -656
WIRE 1600 -608 1600 -816
WIRE 1616 -608 1600 -608
WIRE 1712 -608 1696 -608
WIRE 848 -592 848 -816
WIRE 880 -592 848 -592
WIRE 976 -592 976 -752
WIRE 976 -592 960 -592
WIRE 336 -576 336 -736
WIRE 368 -576 336 -576
WIRE 1440 -576 1376 -576
WIRE 464 -560 464 -656
WIRE 464 -560 432 -560
WIRE 976 -560 976 -592
WIRE 992 -560 976 -560
WIRE 1600 -560 1600 -608
WIRE 1600 -560 1504 -560
WIRE -64 -544 -96 -544
WIRE 64 -544 0 -544
WIRE 176 -544 64 -544
WIRE 336 -544 256 -544
WIRE 368 -544 336 -544
WIRE 1152 -544 1152 -752
WIRE 1152 -544 1056 -544
WIRE 1216 -544 1152 -544
WIRE 1408 -544 1296 -544
WIRE 1440 -544 1408 -544
WIRE 992 -528 880 -528
WIRE 64 -512 64 -544
WIRE 1408 -432 1408 -544
WIRE 1456 -432 1408 -432
WIRE 1600 -432 1600 -560
WIRE 1600 -432 1536 -432
WIRE 3744 -320 3728 -320
WIRE 3776 -320 3744 -320
WIRE 3888 -320 3856 -320
WIRE 3008 -256 2880 -256
WIRE 3168 -256 3072 -256
WIRE 5440 -256 5312 -256
WIRE 5808 -256 5504 -256
WIRE 4864 -224 4864 -256
WIRE 1232 -176 1008 -176
WIRE 1456 -176 1232 -176
WIRE 2880 -160 2880 -256
WIRE 2992 -160 2880 -160
WIRE 3168 -160 3168 -256
WIRE 3168 -160 3072 -160
WIRE 3232 -160 3168 -160
WIRE 1456 -128 1456 -176
WIRE 3744 -128 3744 -320
WIRE 3792 -128 3744 -128
WIRE 4688 -128 4336 -128
WIRE 1008 -112 1008 -176
WIRE 3888 -112 3888 -320
WIRE 3888 -112 3856 -112
WIRE 4864 -112 4864 -144
WIRE 4864 -112 4752 -112
WIRE 4928 -112 4864 -112
WIRE 3648 -96 3552 -96
WIRE 3792 -96 3648 -96
WIRE 3888 -96 3888 -112
WIRE 4112 -96 3888 -96
WIRE 4480 -96 4336 -96
WIRE 4576 -96 4560 -96
WIRE 4688 -96 4576 -96
WIRE 5312 -96 5312 -256
WIRE 5312 -96 5264 -96
WIRE 5344 -96 5312 -96
WIRE 5472 -96 5424 -96
WIRE 5600 -96 5472 -96
WIRE 5872 -80 5664 -80
WIRE 5600 -64 5536 -64
WIRE 512 -48 512 -80
WIRE 3648 -48 3648 -96
WIRE 5472 -48 5472 -96
WIRE 2720 -16 2560 -16
WIRE 2880 -16 2880 -160
WIRE 2880 -16 2720 -16
WIRE 2960 -16 2880 -16
WIRE 3168 0 3168 -160
WIRE 3168 0 3024 0
WIRE 1232 16 1232 -176
WIRE 2960 16 2928 16
WIRE 4576 32 4576 -96
WIRE 4656 32 4576 32
WIRE 4864 32 4864 -112
WIRE 4864 32 4736 32
WIRE 336 48 -16 48
WIRE 512 64 512 32
WIRE 512 64 400 64
WIRE 576 64 512 64
WIRE 1008 64 1008 -32
WIRE 1168 64 1008 64
WIRE 2928 64 2928 16
WIRE 3024 64 2928 64
WIRE 5472 64 5472 16
WIRE 128 80 -16 80
WIRE 224 80 208 80
WIRE 336 80 224 80
WIRE 2560 80 2560 -16
WIRE 2720 80 2720 -16
WIRE 2880 80 2880 -16
WIRE 3648 80 3648 32
WIRE 5536 80 5536 -64
WIRE 5808 80 5808 -256
WIRE 5808 80 5536 80
WIRE 3024 96 3024 64
WIRE 1456 160 1456 -64
WIRE 224 208 224 80
WIRE 304 208 224 208
WIRE 512 208 512 64
WIRE 512 208 384 208
WIRE 1008 208 1008 64
WIRE 1232 208 1232 112
WIRE 1392 208 1232 208
WIRE 2560 240 2560 160
WIRE 2720 240 2720 144
WIRE 2720 240 2560 240
WIRE 2880 240 2880 160
WIRE 2880 240 2720 240
WIRE 1232 288 1232 208
WIRE 1456 288 1456 256
WIRE 2720 320 2720 240
WIRE 1008 384 1008 288
WIRE 1232 384 1232 368
WIRE 1232 384 1008 384
WIRE 1456 384 1456 368
WIRE 1456 384 1232 384
WIRE 1232 400 1232 384
WIRE 576 1360 480 1360
WIRE 704 1360 576 1360
WIRE 576 1440 480 1440
WIRE 480 1472 480 1440
FLAG 32 1392 0
FLAG 32 1312 Vin
FLAG 2720 320 0
FLAG 2608 672 0
FLAG 2992 32 0
FLAG 2992 -32 Vsupply
FLAG 2608 592 Vbias
FLAG 3024 96 Vbias
FLAG 3232 -160 Vdet
FLAG 3488 -96 Vdet
FLAG -256 1392 0
FLAG -256 1312 Vsupply
FLAG 5632 -48 0
FLAG 5472 64 0
FLAG 5872 -80 Vout
FLAG 5632 -112 Vsupply
FLAG 3648 80 Vbias
FLAG 5184 -96 Vrx
FLAG 1152 -544 Vtri
FLAG 1472 -528 0
FLAG 1024 -512 0
FLAG 880 -528 Vref
FLAG 1376 -576 Vref
FLAG 1600 -560 Vsq
FLAG 1024 -576 Vsupply
FLAG 1472 -592 Vsupply
FLAG 1712 -608 Vsupply
FLAG 224 -736 0
FLAG 336 -464 Vref
FLAG 400 -528 0
FLAG 400 -592 Vsupply
FLAG 64 -432 0
FLAG 368 32 Vsupply
FLAG 368 96 0
FLAG 528 -656 Visc
FLAG -16 48 Vtri
FLAG 512 -80 Vsupply
FLAG 576 64 Vpwm
FLAG 1232 -176 Vsupply
FLAG 1008 64 Vpwm
FLAG 1232 400 0
FLAG -96 -544 Vin
FLAG -16 80 Visc
FLAG 480 1472 0
FLAG 480 1280 Vsupply
FLAG 704 1360 Vref
FLAG 3824 -80 0
FLAG 3824 -144 Vsupply
FLAG 3648 -320 Vbias
FLAG 4720 -144 Vsupply
FLAG 4720 -80 0
FLAG 4336 -128 Vbias
FLAG 4864 -256 Vsupply
FLAG 4928 -112 Vrx
FLAG 4112 -96 Vamp
FLAG 4336 -96 Vamp
SYMBOL voltage 32 1296 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V3
SYMATTR Value SINE({Vin_offset} {A} {f})
SYMBOL bi 2560 80 R0
WINDOW 3 -541 40 Left 2
SYMATTR Value I=9.5e-6*I(D1)+15e-9*white(1e8*time)
SYMATTR InstName I_P
SYMBOL cap 2704 80 R0
WINDOW 3 24 36 Left 2
SYMATTR Value 4.25p
SYMATTR InstName C_0
SYMBOL res 2864 64 R0
WINDOW 3 36 68 Left 2
SYMATTR Value 16.6G
SYMATTR InstName R_leak
SYMBOL cap 3072 -272 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C1
SYMATTR Value 7.5p
SYMBOL res 3088 -176 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R1
SYMATTR Value 100k
SYMBOL voltage 2608 576 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V1
SYMATTR Value 2.5
SYMBOL cap 3552 -112 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C2
SYMATTR Value 27n
SYMBOL res 3632 -64 R0
SYMATTR InstName R2
SYMATTR Value 10k
SYMBOL OpAmps\\opamp2 2992 -64 R0
SYMATTR InstName U2
SYMATTR Value LM358
SYMBOL voltage -256 1296 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V4
SYMATTR Value {Vsupply}
SYMBOL cap 5456 -48 R0
SYMATTR InstName C5
SYMATTR Value 180p
SYMBOL res 5440 -112 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R26
SYMATTR Value 180k
SYMBOL res 5280 -112 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R27
SYMATTR Value 180k
SYMBOL cap 5504 -272 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C6
SYMATTR Value 680p
SYMBOL OpAmps\\UniversalOpAmp2 5632 -80 M180
SYMATTR InstName U9
SYMBOL LED 1440 -128 R0
SYMATTR InstName D1
SYMATTR Value KA3529
SYMBOL res 976 -608 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R3
SYMATTR Value {R1}
SYMBOL cap 1104 -768 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C3
SYMATTR Value {C1}
SYMATTR SpiceLine Rser=10m
SYMBOL res 1312 -560 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R4
SYMATTR Value {R2}
SYMBOL res 1552 -448 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R5
SYMATTR Value {R3}
SYMBOL res 1712 -624 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R6
SYMATTR Value 1k
SYMBOL res 272 -560 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R8
SYMATTR Value 68k
SYMBOL res 352 -448 R180
WINDOW 0 36 76 Left 2
WINDOW 3 36 40 Left 2
SYMATTR InstName R9
SYMATTR Value 33k
SYMBOL res 352 -720 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 0 56 VBottom 2
SYMATTR InstName R10
SYMATTR Value 33k
SYMBOL res 208 -720 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 0 56 VBottom 2
SYMATTR InstName R11
SYMATTR Value 68k
SYMBOL cap 0 -560 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C4
SYMATTR Value 1µ
SYMBOL res 48 -528 R0
SYMATTR InstName R14
SYMATTR Value 8.5k
SYMBOL res 400 192 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R15
SYMATTR Value 27k
SYMBOL res 224 64 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R16
SYMATTR Value 1k
SYMBOL res 496 -64 R0
SYMATTR InstName R17
SYMATTR Value 1k
SYMBOL OpAmps\\opamp2 400 -624 R0
WINDOW 3 24 82 Left 2
SYMATTR Value LM358
SYMATTR InstName U3
SYMBOL OpAmps\\opamp2 1024 -608 R0
WINDOW 3 22 83 Left 2
SYMATTR Value LM358
SYMATTR InstName U5
SYMBOL OpAmps\\opamp2 1472 -624 R0
WINDOW 3 24 80 Left 2
SYMATTR Value LM393A
SYMATTR InstName U6
SYMBOL OpAmps\\opamp2 368 0 R0
WINDOW 3 22 81 Left 2
SYMATTR Value LM393A
SYMATTR InstName U7
SYMBOL npn 1168 16 R0
SYMATTR InstName Q1
SYMATTR Value BC547B
SYMBOL res 992 -128 R0
SYMATTR InstName R18
SYMATTR Value 2.2k
SYMBOL res 992 192 R0
SYMATTR InstName R19
SYMATTR Value 1k
SYMBOL res 1216 272 R0
SYMATTR InstName R20
SYMATTR Value 1k
SYMBOL res 1440 272 R0
SYMATTR InstName R21
SYMATTR Value 15.95
SYMBOL npn 1392 160 R0
SYMATTR InstName Q2
SYMATTR Value BC639
SYMBOL res 464 1264 R0
SYMATTR InstName R12
SYMATTR Value 18k
SYMBOL res 464 1344 R0
SYMATTR InstName R13
SYMATTR Value 27k
SYMBOL res 560 1344 R0
SYMATTR InstName R22
SYMATTR Value 39k
SYMBOL res 3872 -336 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R24
SYMATTR Value 56k
SYMBOL res 3744 -336 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R25
SYMATTR Value 20k
SYMBOL OpAmps\\opamp2 3824 -176 R0
SYMATTR InstName U1
SYMATTR Value LM324
SYMBOL res 4752 16 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R28
SYMATTR Value 1Meg
SYMBOL res 4576 -112 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R29
SYMATTR Value 1k
SYMBOL res 4848 -240 R0
SYMATTR InstName R30
SYMATTR Value 1k
SYMBOL OpAmps\\opamp2 4720 -176 R0
WINDOW 3 22 81 Left 2
SYMATTR Value LM393A
SYMATTR InstName U8
TEXT 3472 1272 Left 2 !.tran 0 1.5m 1m startup
TEXT 1144 1584 Left 2 !.param f=2.5k Vin_offset=3V A=1
TEXT 2560 -40 Left 2 ;Photo-diode
TEXT 1144 1560 Left 2 ;For this param, change f between 1-2.5k, Vin_offset keep between 2-3V, and keep A low (around 1V)
TEXT 3664 528 Left 2 ;Example SPICE directive for obtaining harmonic components\n.fourier {f} 100 V(vout)
TEXT 2736 536 Left 2 ;Photo-diode\nWhen the transmitter and receiver are 100mm apart use the equation\nI=9.5e-6*I(D1)+15e-9*white(1e8*time)\n \nWhen the transmitter and receiver are 400mm apart use the equation\nI=0.55e-6*I(D1)+15e-9*white(1e8*time)
TEXT 360 760 Left 7 ;Transmitter
TEXT 3152 800 Left 7 ;Receiver
TEXT 1152 1720 Left 2 !.include LM393A.5_1
TEXT 1168 1760 Left 2 !.include eee305.lib
TEXT 2752 720 Left 2 ;.fourier {f} 100 V(vdet)
TEXT 3072 -216 Left 2 ;15//15
TEXT 1136 1000 Left 2 !.param C1=15n Vref=2 Vsupply=5 R1=1k R2=33k R3=82k
TEXT 1136 968 Left 2 !.param Vinput_frequency=1k Vinput_offset=3
TEXT 1136 1208 Left 2 !.model KA3529 D(Is=1.00E-20 N=1.806 Rs=2.616247 Eg=2.26 Xti=3)
TEXT 1136 1240 Left 2 !.model BC639 NPN (AF= 1.00E+00 BF= 1.29E+02 BR= 2.92E+00 CJC= 4.85E-11 \n+ CJE= 1.17E-10 CJS= 0.00E+00 EG= 1.11E+00 FC= 5.00E-01 IKF= 9.06E-01 \n+ IKR= 1.00E+00 IRB= 2.38E-02 IS= 3.06E-15 ISC= 4.08E-14   ISE= 1.62E-16 \n+ ITF= 5.64E-01 KF=0.00E+00 MJC= 5.09E-01 MJE= 4.22E-01 MJS= 3.30E-01 \n+ NC=1.00E+00 NE= 1.00E+00 NF= 8.55E-01 NR= 9.10E-01 PTF=0.00E+00 \n+ RB= 1.65E+01 RBM= 1.73E-02 RC= 3.11E-01 RE= 1.26E-02 TF= 1.42E-09  \n+ TR= 0.00E+00 VAF= 7.24E+02 VAR=5.46E+01 VJC= 3.00E-01 VJE= 3.00E-01 \n+ VJS= 7.50E-01 VTF=9.99E+05 XCJC= 1.00E+00 XTB= 0.00E+00 \n+ XTF= 7.75E-01 XTI=3.00E+00)
TEXT -288 1440 Left 2 ;L78L05ACZ 5V DC\nlinear regulator
TEXT -120 976 Left 3 ;Voltage Sources/Signals
TEXT -192 -1680 Left 5 ;ELECTENG 310 Assignment1\nGroup 6\n \nThomas Cummings\nDemian Pillay\nAshley v.d. Merwe
TEXT -448 1784 Left 2 ;.ac oct 10 1 1Meg
TEXT 1472 376 Left 2 ;27//39ohm
TEXT 1040 -936 Left 3 ;Triangle Waveform Generator
TEXT 56 -912 Left 3 ;Input Signal Conditioner
TEXT 1152 -240 Left 3 ;LED Driver
TEXT 208 -248 Left 3 ;PWM Generator
TEXT 408 1520 Left 2 ;2V reference \ngenerator circuit
TEXT 408 1584 Left 2 ;Ideally intended to be 2.35
LINE Normal 1936 -1088 1936 688
LINE Normal -288 -1088 1936 -1088
LINE Normal -304 688 1920 688
LINE Normal -304 -1104 -304 672
