Version 4
SHEET 1 5944 2120
WIRE 1456 -928 704 -928
WIRE 1472 -928 1456 -928
WIRE 1568 -928 1552 -928
WIRE 896 -864 832 -864
WIRE 1008 -864 960 -864
WIRE 192 -848 160 -848
WIRE 224 -848 192 -848
WIRE 320 -848 304 -848
WIRE 320 -768 320 -848
WIRE 384 -768 320 -768
WIRE 704 -704 704 -928
WIRE 736 -704 704 -704
WIRE 832 -704 832 -864
WIRE 832 -704 816 -704
WIRE 192 -688 192 -848
WIRE 224 -688 192 -688
WIRE 1296 -688 1232 -688
WIRE 320 -672 320 -768
WIRE 320 -672 288 -672
WIRE 832 -672 832 -704
WIRE 848 -672 832 -672
WIRE 1456 -672 1456 -928
WIRE 1456 -672 1360 -672
WIRE -208 -656 -240 -656
WIRE -80 -656 -144 -656
WIRE 32 -656 -80 -656
WIRE 192 -656 112 -656
WIRE 224 -656 192 -656
WIRE 1008 -656 1008 -864
WIRE 1008 -656 912 -656
WIRE 1072 -656 1008 -656
WIRE 1264 -656 1152 -656
WIRE 1296 -656 1264 -656
WIRE 848 -640 736 -640
WIRE -80 -624 -80 -656
WIRE 1264 -544 1264 -656
WIRE 1312 -544 1264 -544
WIRE 1456 -544 1456 -672
WIRE 1456 -544 1392 -544
WIRE 1088 -288 864 -288
WIRE 1312 -288 1088 -288
WIRE 3008 -256 2880 -256
WIRE 3168 -256 3072 -256
WIRE 5440 -256 5312 -256
WIRE 5808 -256 5504 -256
WIRE 1312 -240 1312 -288
WIRE 864 -224 864 -288
WIRE 4864 -224 4864 -256
WIRE 368 -160 368 -192
WIRE 2880 -160 2880 -256
WIRE 2992 -160 2880 -160
WIRE 3168 -160 3168 -256
WIRE 3168 -160 3072 -160
WIRE 3232 -160 3168 -160
WIRE 4688 -128 4336 -128
WIRE 4864 -112 4864 -144
WIRE 4864 -112 4752 -112
WIRE 4928 -112 4864 -112
WIRE 1088 -96 1088 -288
WIRE 3648 -96 3552 -96
WIRE 4112 -96 3648 -96
WIRE 4688 -96 4336 -96
WIRE 5312 -96 5312 -256
WIRE 5312 -96 5264 -96
WIRE 5344 -96 5312 -96
WIRE 5472 -96 5424 -96
WIRE 5600 -96 5472 -96
WIRE 5872 -80 5664 -80
WIRE 192 -64 -160 -64
WIRE 5600 -64 5536 -64
WIRE 368 -48 368 -80
WIRE 368 -48 256 -48
WIRE 432 -48 368 -48
WIRE 864 -48 864 -144
WIRE 1024 -48 864 -48
WIRE 3648 -48 3648 -96
WIRE 5472 -48 5472 -96
WIRE -16 -32 -160 -32
WIRE 80 -32 64 -32
WIRE 192 -32 80 -32
WIRE 2720 -16 2560 -16
WIRE 2880 -16 2880 -160
WIRE 2880 -16 2720 -16
WIRE 2960 -16 2880 -16
WIRE 3168 0 3168 -160
WIRE 3168 0 3024 0
WIRE 2960 16 2928 16
WIRE 1312 48 1312 -176
WIRE 2928 64 2928 16
WIRE 3024 64 2928 64
WIRE 5472 64 5472 16
WIRE 2560 80 2560 -16
WIRE 2720 80 2720 -16
WIRE 2880 80 2880 -16
WIRE 3648 80 3648 32
WIRE 5536 80 5536 -64
WIRE 5808 80 5808 -256
WIRE 5808 80 5536 80
WIRE 80 96 80 -32
WIRE 160 96 80 96
WIRE 368 96 368 -48
WIRE 368 96 240 96
WIRE 864 96 864 -48
WIRE 1088 96 1088 0
WIRE 1248 96 1088 96
WIRE 3024 96 3024 64
WIRE 1088 176 1088 96
WIRE 1312 176 1312 144
WIRE 2560 240 2560 160
WIRE 2720 240 2720 144
WIRE 2720 240 2560 240
WIRE 2880 240 2880 160
WIRE 2880 240 2720 240
WIRE 864 272 864 176
WIRE 1088 272 1088 256
WIRE 1088 272 864 272
WIRE 1312 272 1312 256
WIRE 1312 272 1088 272
WIRE 1088 288 1088 272
WIRE 2720 320 2720 240
WIRE 512 1312 416 1312
FLAG 32 1392 0
FLAG 32 1312 Vin
FLAG 2720 320 0
FLAG 2608 672 0
FLAG 2992 32 0
FLAG 2992 -32 Vsupply
FLAG 2608 592 Vbias
FLAG 3024 96 Vbias
FLAG 3232 -160 Vdet
FLAG 3488 -96 Vdet
FLAG 4720 -144 Vsupply
FLAG 4720 -80 0
FLAG 4336 -128 Vbias
FLAG 4864 -256 Vsupply
FLAG 4928 -112 Vrx
FLAG -256 1392 0
FLAG -256 1312 Vsupply
FLAG 1008 -656 Vtri
FLAG 1328 -640 0
FLAG 880 -624 0
FLAG 736 -640 Vref
FLAG 1232 -688 Vref
FLAG 1456 -672 Vsq
FLAG 880 -688 Vsupply
FLAG 1328 -704 Vsupply
FLAG 1568 -928 Vsupply
FLAG 416 1392 0
FLAG 416 1232 Vsupply
FLAG 80 -848 0
FLAG 192 -576 Vref
FLAG 256 -640 0
FLAG 256 -704 Vsupply
FLAG -80 -544 0
FLAG 224 -80 Vsupply
FLAG 224 -16 0
FLAG 384 -768 Visc
FLAG -160 -64 Vtri
FLAG 368 -192 Vsupply
FLAG 432 -48 Vpwm
FLAG 1088 -288 Vsupply
FLAG 864 -48 Vpwm
FLAG 1088 288 0
FLAG -240 -656 Vin
FLAG -160 -32 Visc
FLAG 512 1312 Vref
FLAG 4112 -96 Vamp
FLAG 4336 -96 Vamp
FLAG 5632 -48 0
FLAG 5472 64 0
FLAG 5872 -80 Vout
FLAG 5632 -112 Vsupply
FLAG 3648 80 Vbias
FLAG 5184 -96 Vrx
SYMBOL voltage 32 1296 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V3
SYMATTR Value SINE({Vin_offset} {A} {f})
SYMBOL LED 1296 -240 R0
SYMATTR InstName D1
SYMATTR Value KA3529
SYMBOL bi 2560 80 R0
WINDOW 3 -541 40 Left 2
SYMATTR Value I=9.5e-6*I(D1)+15e-9*white(1e8*time)
SYMATTR InstName I_P
SYMBOL cap 2704 80 R0
WINDOW 3 24 36 Left 2
SYMATTR Value 4.25p
SYMATTR InstName C_0
SYMBOL res 2864 64 R0
WINDOW 3 36 68 Left 2
SYMATTR Value 16.6G
SYMATTR InstName R_leak
SYMBOL cap 3072 -272 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C1
SYMATTR Value 7.5p
SYMBOL res 3088 -176 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R1
SYMATTR Value 100k
SYMBOL voltage 2608 576 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V1
SYMATTR Value 2.5
SYMBOL OpAmps\\opamp2 2256 -640 R0
SYMATTR InstName U1
SYMATTR Value LM358
SYMBOL cap 3552 -112 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C2
SYMATTR Value 27n
SYMBOL res 3632 -64 R0
SYMATTR InstName R2
SYMATTR Value 10k
SYMBOL OpAmps\\opamp2 2992 -64 R0
SYMATTR InstName U2
SYMATTR Value LM358
SYMBOL res 4848 -240 R0
SYMATTR InstName R7
SYMATTR Value 1k
SYMBOL OpAmps\\opamp2 4720 -176 R0
WINDOW 3 22 81 Left 2
SYMATTR Value LM393A
SYMATTR InstName U4
SYMBOL voltage -256 1296 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V4
SYMATTR Value {Vsupply}
SYMBOL res 832 -720 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R8
SYMATTR Value {R1}
SYMBOL cap 960 -880 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C3
SYMATTR Value {C1}
SYMATTR SpiceLine Rser=10m
SYMBOL res 1168 -672 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R9
SYMATTR Value {R2}
SYMBOL res 1408 -560 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R10
SYMATTR Value {R3}
SYMBOL res 1568 -944 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R11
SYMATTR Value 1k
SYMBOL res 400 1216 R0
SYMATTR InstName R12
SYMATTR Value 3k
SYMBOL res 400 1296 R0
SYMATTR InstName R13
SYMATTR Value 2k
SYMBOL res 128 -672 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R14
SYMATTR Value 68k
SYMBOL res 208 -560 R180
WINDOW 0 36 76 Left 2
WINDOW 3 36 40 Left 2
SYMATTR InstName R15
SYMATTR Value 33k
SYMBOL res 208 -832 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 0 56 VBottom 2
SYMATTR InstName R16
SYMATTR Value 33k
SYMBOL res 64 -832 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 0 56 VBottom 2
SYMATTR InstName R17
SYMATTR Value 68k
SYMBOL cap -144 -672 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C4
SYMATTR Value 1µ
SYMBOL res -96 -640 R0
SYMATTR InstName R18
SYMATTR Value 8.5k
SYMBOL res 256 80 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R19
SYMATTR Value 27k
SYMBOL res 80 -48 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R20
SYMATTR Value 1k
SYMBOL res 352 -176 R0
SYMATTR InstName R21
SYMATTR Value 1k
SYMBOL OpAmps\\opamp2 256 -736 R0
WINDOW 3 24 82 Left 2
SYMATTR Value LM358
SYMATTR InstName U5
SYMBOL OpAmps\\opamp2 880 -720 R0
WINDOW 3 22 83 Left 2
SYMATTR Value LM358
SYMATTR InstName U6
SYMBOL OpAmps\\opamp2 1328 -736 R0
WINDOW 3 24 80 Left 2
SYMATTR Value LM393A
SYMATTR InstName U7
SYMBOL OpAmps\\opamp2 224 -112 R0
WINDOW 3 22 81 Left 2
SYMATTR Value LM393A
SYMATTR InstName U8
SYMBOL npn 1024 -96 R0
SYMATTR InstName Q1
SYMATTR Value BC547B
SYMBOL res 848 -240 R0
SYMATTR InstName R22
SYMATTR Value 2.2k
SYMBOL res 848 80 R0
SYMATTR InstName R23
SYMATTR Value 1k
SYMBOL res 1072 160 R0
SYMATTR InstName R24
SYMATTR Value 1k
SYMBOL res 1296 160 R0
SYMATTR InstName R25
SYMATTR Value 15.95
SYMBOL npn 1248 48 R0
SYMATTR InstName Q2
SYMATTR Value BC639
SYMBOL cap 5456 -48 R0
SYMATTR InstName C5
SYMATTR Value 180p
SYMBOL res 5440 -112 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R26
SYMATTR Value 180k
SYMBOL res 5280 -112 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R27
SYMATTR Value 180k
SYMBOL cap 5504 -272 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C6
SYMATTR Value 680p
SYMBOL OpAmps\\UniversalOpAmp2 5632 -80 M180
SYMATTR InstName U9
TEXT 3472 1272 Left 2 !.tran 0 1.5m 1m startup
TEXT 1144 1584 Left 2 !.param f=2.5k Vin_offset=3V A=1
TEXT 2560 -40 Left 2 ;Photo-diode
TEXT 1144 1560 Left 2 ;For this param, change f between 1-2.5k, Vin_offset keep between 2-3V, and keep A low (around 1V)
TEXT 3664 528 Left 2 ;Example SPICE directive for obtaining harmonic components\n.fourier {f} 100 V(vout)
TEXT 2736 536 Left 2 ;Photo-diode\nWhen the transmitter and receiver are 100mm apart use the equation\nI=9.5e-6*I(D1)+15e-9*white(1e8*time)\n \nWhen the transmitter and receiver are 400mm apart use the equation\nI=0.55e-6*I(D1)+15e-9*white(1e8*time)
TEXT 360 760 Left 7 ;Transmitter
TEXT 3152 800 Left 7 ;Receiver
TEXT 1152 1720 Left 2 !.include LM393A.5_1
TEXT 1168 1760 Left 2 !.include eee305.lib
TEXT 2752 720 Left 2 ;.fourier {f} 100 V(vdet)
TEXT 3072 -216 Left 2 ;15//15
TEXT 1136 1000 Left 2 !.param C1=15n Vref=2 Vsupply=5 R1=1k R2=33k R3=82k
TEXT 1136 968 Left 2 !.param Vinput_frequency=1k Vinput_offset=3
TEXT 1136 1208 Left 2 !.model KA3529 D(Is=1.00E-20 N=1.806 Rs=2.616247 Eg=2.26 Xti=3)
TEXT 1328 264 Left 2 ;27//39ohm
TEXT 896 -1048 Left 3 ;Triangle Waveform Generator
TEXT -88 -1024 Left 3 ;Input Signal Conditioner
TEXT 1008 -352 Left 3 ;LED Driver
TEXT 64 -360 Left 3 ;PWM Generator
TEXT 1136 1240 Left 2 !.model BC639 NPN (AF= 1.00E+00 BF= 1.29E+02 BR= 2.92E+00 CJC= 4.85E-11 \n+ CJE= 1.17E-10 CJS= 0.00E+00 EG= 1.11E+00 FC= 5.00E-01 IKF= 9.06E-01 \n+ IKR= 1.00E+00 IRB= 2.38E-02 IS= 3.06E-15 ISC= 4.08E-14   ISE= 1.62E-16 \n+ ITF= 5.64E-01 KF=0.00E+00 MJC= 5.09E-01 MJE= 4.22E-01 MJS= 3.30E-01 \n+ NC=1.00E+00 NE= 1.00E+00 NF= 8.55E-01 NR= 9.10E-01 PTF=0.00E+00 \n+ RB= 1.65E+01 RBM= 1.73E-02 RC= 3.11E-01 RE= 1.26E-02 TF= 1.42E-09  \n+ TR= 0.00E+00 VAF= 7.24E+02 VAR=5.46E+01 VJC= 3.00E-01 VJE= 3.00E-01 \n+ VJS= 7.50E-01 VTF=9.99E+05 XCJC= 1.00E+00 XTB= 0.00E+00 \n+ XTF= 7.75E-01 XTI=3.00E+00)
TEXT -288 1440 Left 2 ;L78L05ACZ 5V DC\nlinear regulator
TEXT 392 1440 Left 2 ;2V reference \ngenerator circuit
TEXT -120 976 Left 3 ;Voltage Sources/Signals
TEXT -192 -1680 Left 5 ;ELECTENG 310 Assignment1\nGroup 6\n \nThomas Cummings\nDemian Pillay\nAshley v.d. Merwe
TEXT -448 1784 Left 2 ;.ac oct 10 1 1Meg
LINE Normal 1792 -1200 1792 576
LINE Normal -432 -1200 1792 -1200
LINE Normal -448 576 1776 576
LINE Normal -448 -1216 -448 560
