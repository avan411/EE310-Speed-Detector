Version 4
SHEET 1 9204 2120
WIRE 2496 -1104 2464 -1104
WIRE 2608 -1104 2560 -1104
WIRE 2704 -1104 2672 -1104
WIRE 1616 -1072 1616 -1088
WIRE 3232 -1008 3168 -1008
WIRE 3376 -1008 3312 -1008
WIRE 3472 -1008 3376 -1008
WIRE 3632 -1008 3552 -1008
WIRE 0 -976 -96 -976
WIRE 144 -976 80 -976
WIRE 208 -976 144 -976
WIRE 336 -976 288 -976
WIRE 400 -976 336 -976
WIRE 1616 -976 1616 -992
WIRE 1616 -976 800 -976
WIRE 2464 -976 2464 -1104
WIRE 2544 -976 2464 -976
WIRE 2704 -976 2704 -1104
WIRE 2704 -976 2624 -976
WIRE 2768 -976 2704 -976
WIRE 800 -880 800 -976
WIRE 832 -880 800 -880
WIRE 928 -880 912 -880
WIRE 1008 -880 928 -880
WIRE 1168 -880 1072 -880
WIRE 144 -816 144 -976
WIRE 224 -816 144 -816
WIRE 2160 -816 2000 -816
WIRE 2320 -816 2160 -816
WIRE 2464 -816 2464 -976
WIRE 2464 -816 2320 -816
WIRE 2544 -816 2464 -816
WIRE 3376 -816 3376 -1008
WIRE 3488 -816 3376 -816
WIRE 336 -800 336 -976
WIRE 336 -800 288 -800
WIRE 2704 -800 2704 -976
WIRE 2704 -800 2608 -800
WIRE 3632 -800 3632 -1008
WIRE 3632 -800 3552 -800
WIRE -240 -784 -272 -784
WIRE -112 -784 -176 -784
WIRE 0 -784 -112 -784
WIRE 144 -784 80 -784
WIRE 224 -784 144 -784
WIRE 2544 -784 2464 -784
WIRE 3232 -784 3168 -784
WIRE 3376 -784 3296 -784
WIRE 3488 -784 3376 -784
WIRE 3632 -784 3632 -800
WIRE 3808 -784 3632 -784
WIRE -112 -752 -112 -784
WIRE 144 -752 144 -784
WIRE 1456 -736 1376 -736
WIRE 3376 -736 3376 -784
WIRE 928 -720 928 -880
WIRE 1008 -720 928 -720
WIRE 1616 -720 1616 -976
WIRE 1616 -720 1520 -720
WIRE 2000 -720 2000 -816
WIRE 2160 -720 2160 -816
WIRE 2320 -720 2320 -816
WIRE 1168 -704 1168 -880
WIRE 1168 -704 1072 -704
WIRE 1232 -704 1168 -704
WIRE 1376 -704 1312 -704
WIRE 1456 -704 1376 -704
WIRE 1008 -688 848 -688
WIRE -112 -640 -112 -672
WIRE 144 -640 144 -672
WIRE 3376 -608 3376 -656
WIRE 1376 -592 1376 -704
WIRE 1456 -592 1376 -592
WIRE 1616 -592 1616 -720
WIRE 1616 -592 1536 -592
WIRE 2000 -560 2000 -640
WIRE 2160 -560 2160 -656
WIRE 2160 -560 2000 -560
WIRE 2320 -560 2320 -640
WIRE 2320 -560 2160 -560
WIRE 2160 -528 2160 -560
WIRE 1152 -192 912 -192
WIRE 1376 -192 1152 -192
WIRE 912 -128 912 -192
WIRE 1376 -64 1376 -192
WIRE 1152 -32 1152 -192
WIRE 3440 -32 3344 -32
WIRE 3600 -32 3504 -32
WIRE 3840 -32 3600 -32
WIRE 320 0 320 -32
WIRE 2624 0 2624 -48
WIRE 912 16 912 -48
WIRE 1088 16 912 16
WIRE 1376 48 1376 0
WIRE 144 96 -208 96
WIRE 1152 96 1152 64
WIRE 1312 96 1152 96
WIRE 3600 96 3600 -32
WIRE 3680 96 3600 96
WIRE 320 112 320 80
WIRE 320 112 208 112
WIRE 384 112 320 112
WIRE 2448 112 2096 112
WIRE 3840 112 3840 -32
WIRE 3840 112 3744 112
WIRE -128 128 -208 128
WIRE 32 128 -48 128
WIRE 144 128 32 128
WIRE 2624 128 2624 80
WIRE 2624 128 2512 128
WIRE 2688 128 2624 128
WIRE 3184 128 3104 128
WIRE 3344 128 3344 -32
WIRE 3344 128 3264 128
WIRE 3440 128 3344 128
WIRE 3600 128 3520 128
WIRE 3680 128 3600 128
WIRE 2192 144 2096 144
WIRE 2336 144 2272 144
WIRE 2448 144 2336 144
WIRE 3600 192 3600 128
WIRE 912 224 912 16
WIRE 1152 224 1152 96
WIRE 32 256 32 128
WIRE 144 256 32 256
WIRE 320 256 320 112
WIRE 320 256 224 256
WIRE 1376 272 1376 144
WIRE 1520 272 1376 272
WIRE 2336 272 2336 144
WIRE 2448 272 2336 272
WIRE 2624 272 2624 128
WIRE 2624 272 2528 272
WIRE 3600 304 3600 256
WIRE 1376 320 1376 272
WIRE 1520 320 1520 272
WIRE 912 448 912 304
WIRE 1152 448 1152 304
WIRE 1152 448 912 448
WIRE 1376 448 1376 400
WIRE 1376 448 1152 448
WIRE 1520 448 1520 400
WIRE 1520 448 1376 448
WIRE 1152 464 1152 448
WIRE -160 1424 -320 1424
WIRE 336 1424 176 1424
WIRE -320 1456 -320 1424
WIRE 176 1456 176 1424
WIRE -320 1568 -320 1536
WIRE -160 1568 -320 1568
WIRE 176 1568 176 1536
WIRE 336 1568 176 1568
WIRE -320 1600 -320 1568
WIRE 176 1600 176 1568
WIRE -320 1712 -320 1680
WIRE 176 1712 176 1680
FLAG 208 1248 0
FLAG 208 1168 Vin
FLAG 2160 -528 0
FLAG 2576 -768 0
FLAG 2576 -832 Vsupply
FLAG 3520 -768 0
FLAG 3520 -832 Vsupply
FLAG 336 1568 Vbias
FLAG 2464 -784 Vbias
FLAG 3376 -608 Vbias
FLAG 3168 -1008 Vbias
FLAG 2768 -976 Vdet
FLAG 3168 -784 Vdet
FLAG 2480 96 Vsupply
FLAG 2480 160 0
FLAG 2096 112 Vbias
FLAG 2624 -48 Vsupply
FLAG 2688 128 Vrx
FLAG -304 1248 0
FLAG -304 1168 Vsupply
FLAG 1168 -704 Vtri
FLAG 1488 -688 0
FLAG 1040 -672 0
FLAG 848 -688 Vref
FLAG 1376 -736 Vref
FLAG 1616 -720 Vsq
FLAG 1040 -736 Vsupply
FLAG 1488 -752 Vsupply
FLAG 1616 -1088 Vsupply
FLAG -96 -976 0
FLAG 144 -640 Vref
FLAG 256 -768 0
FLAG 256 -832 Vsupply
FLAG -112 -640 0
FLAG 176 80 Vsupply
FLAG 176 144 0
FLAG 400 -976 Visc
FLAG -208 96 Vtri
FLAG 320 -32 Vsupply
FLAG 384 112 Vpwm
FLAG 1152 -192 Vsupply
FLAG 912 16 Vpwm
FLAG 1152 464 0
FLAG -272 -784 Vin
FLAG -208 128 Visc
FLAG 3808 -784 Vamp
FLAG 2096 144 Vamp
FLAG 3600 304 0
FLAG 3712 80 Vsupply
FLAG 3104 128 Vrx
FLAG 3712 144 0
FLAG 3840 112 Vout
FLAG 336 1424 Vsupply
FLAG 176 1712 0
FLAG -160 1568 Vbias
FLAG -160 1424 Vsupply
FLAG -320 1712 0
SYMBOL voltage 208 1152 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V3
SYMATTR Value SINE({Vin_offset} {A} {f})
SYMBOL LED 1360 -64 R0
SYMATTR InstName D1
SYMATTR Value KA3529
SYMBOL bi 2000 -720 R0
WINDOW 3 0 242 Left 2
SYMATTR Value I=9.5e-6*I(D1)+15e-8*white(1e8*time)
SYMATTR InstName I_P
SYMBOL cap 2144 -720 R0
WINDOW 3 24 36 Left 2
SYMATTR Value 4.25p
SYMATTR InstName C_0
SYMBOL res 2304 -736 R0
WINDOW 3 36 68 Left 2
SYMATTR Value 16.6G
SYMATTR InstName R_leak
SYMBOL res 2640 -992 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R1
SYMATTR Value 100k
SYMBOL cap 3296 -800 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C2
SYMATTR Value 100n
SYMBOL res 3360 -752 R0
SYMATTR InstName R2
SYMATTR Value 10k
SYMBOL res 3568 -1024 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R3
SYMATTR Value 56k
SYMBOL res 3328 -1024 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R4
SYMATTR Value 22k
SYMBOL OpAmps\\opamp2 2576 -864 R0
SYMATTR InstName U2
SYMATTR Value LM324
SYMBOL OpAmps\\opamp2 3520 -864 R0
SYMATTR InstName U3
SYMATTR Value LM324
SYMBOL res 2544 256 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R5
SYMATTR Value 1000k
SYMBOL res 2288 128 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R6
SYMATTR Value 1000
SYMBOL res 2608 -16 R0
SYMATTR InstName R7
SYMATTR Value 1k
SYMBOL OpAmps\\opamp2 2480 64 R0
WINDOW 3 22 81 Left 2
SYMATTR Value LM393A
SYMATTR InstName U4
SYMBOL voltage -304 1152 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V4
SYMATTR Value {Vsupply}
SYMBOL res 928 -896 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R8
SYMATTR Value {R1}
SYMBOL cap 1072 -896 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C3
SYMATTR Value {C1}
SYMATTR SpiceLine Rser=10m
SYMBOL res 1328 -720 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R9
SYMATTR Value {R2}
SYMBOL res 1552 -608 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R10
SYMATTR Value {R3}
SYMBOL res 1632 -976 R180
WINDOW 0 36 76 Left 2
WINDOW 3 36 40 Left 2
SYMATTR InstName R11
SYMATTR Value 1k
SYMBOL res 96 -800 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R14
SYMATTR Value 68k
SYMBOL res 160 -656 R180
WINDOW 0 36 76 Left 2
WINDOW 3 36 40 Left 2
SYMATTR InstName R15
SYMATTR Value 33k
SYMBOL res 192 -960 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 0 56 VBottom 2
SYMATTR InstName R16
SYMATTR Value 33k
SYMBOL res -16 -960 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 0 56 VBottom 2
SYMATTR InstName R17
SYMATTR Value 68k
SYMBOL cap -176 -800 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C4
SYMATTR Value 1µ
SYMBOL res -128 -768 R0
SYMATTR InstName R18
SYMATTR Value 8.5k
SYMBOL res 240 240 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R19
SYMATTR Value 27k
SYMBOL res -32 112 R90
WINDOW 0 82 46 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R20
SYMATTR Value 1k
SYMBOL res 304 -16 R0
SYMATTR InstName R21
SYMATTR Value 1k
SYMBOL OpAmps\\opamp2 256 -864 R0
WINDOW 3 24 82 Left 2
SYMATTR Value LM358
SYMATTR InstName U5
SYMBOL OpAmps\\opamp2 1040 -768 R0
WINDOW 3 22 83 Left 2
SYMATTR Value LM358
SYMATTR InstName U6
SYMBOL OpAmps\\opamp2 1488 -784 R0
WINDOW 3 24 80 Left 2
SYMATTR Value LM393A
SYMATTR InstName U7
SYMBOL OpAmps\\opamp2 176 48 R0
WINDOW 3 22 81 Left 2
SYMATTR Value LM393A
SYMATTR InstName U8
SYMBOL npn 1088 -32 R0
SYMATTR InstName Q1
SYMATTR Value BC547B
SYMBOL res 896 -144 R0
SYMATTR InstName R22
SYMATTR Value 2.2k
SYMBOL res 896 208 R0
SYMATTR InstName R23
SYMATTR Value 1k
SYMBOL res 1136 208 R0
SYMATTR InstName R24
SYMATTR Value 1k
SYMBOL res 1360 304 R0
SYMATTR InstName R25
SYMATTR Value 27
SYMBOL npn 1312 48 R0
SYMATTR InstName Q2
SYMATTR Value BC639
SYMBOL res 3280 112 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R26
SYMATTR Value 100k
SYMBOL res 3536 112 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R27
SYMATTR Value 10k
SYMBOL cap 3584 192 R0
SYMATTR InstName C5
SYMATTR Value 820p
SYMBOL cap 3504 -48 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C6
SYMATTR Value 10n
SYMBOL OpAmps\\opamp2 3712 48 R0
SYMATTR InstName U1
SYMATTR Value LM324
SYMBOL res 1504 304 R0
SYMATTR InstName R28
SYMATTR Value 39
SYMBOL cap 2672 -1120 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C7
SYMATTR Value 15p
SYMBOL cap 2560 -1120 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C1
SYMATTR Value 15p
SYMBOL res 160 1440 R0
SYMATTR InstName R29
SYMATTR Value 2.2k
SYMBOL res 160 1584 R0
SYMATTR InstName R30
SYMATTR Value 2.2k
SYMBOL res -336 1440 R0
SYMATTR InstName R31
SYMATTR Value 3k
SYMBOL res -336 1584 R0
SYMATTR InstName R32
SYMATTR Value 2k
TEXT 840 1120 Left 2 !.tran 0 12m 6m startup
TEXT 840 1440 Left 2 !.param f=1k Vin_offset=3V A=1
TEXT 2000 -840 Left 2 ;Photo-diode
TEXT 2000 -456 Left 1 ;If 100mm apart use:\n    I=9.5e-6*I(D1)+15e-9*white(1e8*time)\nIf 400mm apart use:\n    I=0.55e-6*I(D1)+15e-9*white(1e8*time)
TEXT -448 648 Left 7 ;Transmitter
TEXT 1832 648 Left 7 ;Receiver
TEXT 840 1632 Left 2 !.include LM393A.5_1
TEXT 840 1664 Left 2 !.include eee305.lib
TEXT 840 1312 Left 2 !.param C1=15n Vsupply=5 R1=1k R2=33k R3=82k
TEXT 840 1280 Left 2 !.param Vinput_frequency=1k Vinput_offset=3
TEXT 976 -1248 Left 3 ;Triangle Waveform Generator
TEXT -96 -1248 Left 3 ;Input Signal Conditioner
TEXT 1096 -304 Left 3 ;LED Driver
TEXT -8 -304 Left 3 ;PWM Generator
TEXT -328 1296 Left 2 ;L78L05ACZ 5V DC\nlinear regulator
TEXT -328 1760 Left 2 ;2V reference \ngenerator circuit
TEXT -120 912 Left 3 ;Sources/References
TEXT -448 -1696 Left 5 ;ELECTENG 310 Assignment 2\nGroup 6\n \nThomas Cummings\nDemian Pillay\nAshley v.d. Merwe
TEXT 840 1152 Left 2 !.fourier {f} 100 V(vout)
TEXT -456 1928 Left 7 ;Set Up
TEXT 1080 912 Left 3 ;Spice Directives
TEXT 840 1568 Left 2 !.include "KA3529 LTSpice Model.txt"
TEXT 840 1600 Left 2 !.include "BC639 LTSpice Model.txt"
TEXT 848 1248 Left 2 ;Transmitter
TEXT 848 1408 Left 2 ;Reciever
TEXT 848 1088 Left 2 ;Simulation Command
TEXT 848 1536 Left 2 ;File Includes
TEXT 2280 -1248 Left 3 ;Light Detector
TEXT 3248 -1248 Left 3 ;High-pass Filter/Amplification
TEXT 2264 -304 Left 3 ;PWM Regenerator
TEXT 3376 -304 Left 3 ;Low-pass Filter
TEXT 160 1768 Left 2 ;2.5V bias \ngenerator circuit
LINE Normal 656 560 656 -1280
LINE Normal 656 560 656 560 2
LINE Normal 1744 -336 -448 -336
LINE Normal 2944 560 2944 -1280
LINE Normal 2944 560 2944 560 2
LINE Normal 1744 -336 -448 -336
LINE Normal 4032 -336 1840 -336
RECTANGLE Normal -448 -1280 1744 560
RECTANGLE Normal 1840 -1280 4032 560
RECTANGLE Normal -448 1840 656 880
RECTANGLE Normal 656 1840 1760 880
