Version 4
SHEET 1 9204 2120
WIRE 2608 -1104 2496 -1104
WIRE 2784 -1104 2672 -1104
WIRE 1616 -1072 1616 -1088
WIRE 2496 -1008 2496 -1104
WIRE 2592 -1008 2496 -1008
WIRE 2784 -1008 2784 -1104
WIRE 2784 -1008 2672 -1008
WIRE 2848 -1008 2784 -1008
WIRE 3312 -1008 3248 -1008
WIRE 3456 -1008 3392 -1008
WIRE 3552 -1008 3456 -1008
WIRE 3712 -1008 3632 -1008
WIRE 0 -976 -96 -976
WIRE 144 -976 80 -976
WIRE 208 -976 144 -976
WIRE 336 -976 288 -976
WIRE 400 -976 336 -976
WIRE 1616 -976 1616 -992
WIRE 1616 -976 800 -976
WIRE 800 -880 800 -976
WIRE 832 -880 800 -880
WIRE 928 -880 912 -880
WIRE 1008 -880 928 -880
WIRE 1168 -880 1072 -880
WIRE 2336 -864 2176 -864
WIRE 2496 -864 2496 -1008
WIRE 2496 -864 2336 -864
WIRE 2576 -864 2496 -864
WIRE 2784 -848 2784 -1008
WIRE 2784 -848 2640 -848
WIRE 2576 -832 2544 -832
WIRE 144 -816 144 -976
WIRE 224 -816 144 -816
WIRE 3456 -816 3456 -1008
WIRE 3568 -816 3456 -816
WIRE 336 -800 336 -976
WIRE 336 -800 288 -800
WIRE 3712 -800 3712 -1008
WIRE 3712 -800 3632 -800
WIRE -240 -784 -272 -784
WIRE -112 -784 -176 -784
WIRE 0 -784 -112 -784
WIRE 144 -784 80 -784
WIRE 224 -784 144 -784
WIRE 2544 -784 2544 -832
WIRE 2640 -784 2544 -784
WIRE 3312 -784 3248 -784
WIRE 3456 -784 3376 -784
WIRE 3568 -784 3456 -784
WIRE 3712 -784 3712 -800
WIRE 3888 -784 3712 -784
WIRE 2176 -768 2176 -864
WIRE 2336 -768 2336 -864
WIRE 2496 -768 2496 -864
WIRE -112 -752 -112 -784
WIRE 144 -752 144 -784
WIRE 2640 -752 2640 -784
WIRE 1456 -736 1376 -736
WIRE 3456 -736 3456 -784
WIRE 928 -720 928 -880
WIRE 1008 -720 928 -720
WIRE 1616 -720 1616 -976
WIRE 1616 -720 1520 -720
WIRE 1168 -704 1168 -880
WIRE 1168 -704 1072 -704
WIRE 1232 -704 1168 -704
WIRE 1376 -704 1312 -704
WIRE 1456 -704 1376 -704
WIRE 1008 -688 848 -688
WIRE -112 -640 -112 -672
WIRE 144 -640 144 -672
WIRE 2176 -608 2176 -688
WIRE 2336 -608 2336 -704
WIRE 2336 -608 2176 -608
WIRE 2496 -608 2496 -688
WIRE 2496 -608 2336 -608
WIRE 3456 -608 3456 -656
WIRE 1376 -592 1376 -704
WIRE 1456 -592 1376 -592
WIRE 1616 -592 1616 -720
WIRE 1616 -592 1536 -592
WIRE 2336 -528 2336 -608
WIRE 1152 -192 912 -192
WIRE 1376 -192 1152 -192
WIRE 912 -128 912 -192
WIRE 1376 -112 1376 -192
WIRE 2656 -48 2656 -80
WIRE 1152 -32 1152 -192
WIRE 3520 -32 3376 -32
WIRE 3664 -32 3584 -32
WIRE 3872 -32 3664 -32
WIRE 320 0 320 -32
WIRE 912 16 912 -48
WIRE 1088 16 912 16
WIRE 1376 48 1376 -48
WIRE 2480 48 2224 48
WIRE 2656 64 2656 32
WIRE 2656 64 2544 64
WIRE 2720 64 2656 64
WIRE 2272 80 2224 80
WIRE 2400 80 2352 80
WIRE 2480 80 2400 80
WIRE 144 96 -208 96
WIRE 1152 96 1152 64
WIRE 1312 96 1152 96
WIRE 3664 96 3664 -32
WIRE 3712 96 3664 96
WIRE 320 112 320 80
WIRE 320 112 208 112
WIRE 384 112 320 112
WIRE 3872 112 3872 -32
WIRE 3872 112 3776 112
WIRE -128 128 -208 128
WIRE 32 128 -48 128
WIRE 144 128 32 128
WIRE 3248 128 3200 128
WIRE 3376 128 3376 -32
WIRE 3376 128 3328 128
WIRE 3408 128 3376 128
WIRE 3536 128 3488 128
WIRE 3712 128 3536 128
WIRE 3536 192 3536 128
WIRE 912 224 912 16
WIRE 1152 224 1152 96
WIRE 2400 224 2400 80
WIRE 2480 224 2400 224
WIRE 2656 224 2656 64
WIRE 2656 224 2560 224
WIRE 32 256 32 128
WIRE 144 256 32 256
WIRE 320 256 320 112
WIRE 320 256 224 256
WIRE 1376 272 1376 144
WIRE 1520 272 1376 272
WIRE 3536 304 3536 256
WIRE 1376 320 1376 272
WIRE 1520 320 1520 272
WIRE 912 448 912 304
WIRE 1152 448 1152 304
WIRE 1152 448 912 448
WIRE 1376 448 1376 400
WIRE 1376 448 1152 448
WIRE 1520 448 1520 400
WIRE 1520 448 1376 448
WIRE 1152 464 1152 448
WIRE 320 1280 160 1280
WIRE 160 1312 160 1280
WIRE 160 1424 160 1392
WIRE 320 1424 160 1424
WIRE 160 1456 160 1424
WIRE 160 1568 160 1536
FLAG 176 1104 0
FLAG 176 1024 Vin
FLAG 3600 -768 0
FLAG 3600 -832 Vsupply
FLAG 496 1424 Vbias
FLAG 3456 -608 Vbias
FLAG 3248 -1008 Vbias
FLAG 3248 -784 Vdet
FLAG -320 1104 0
FLAG -320 1024 Vsupply
FLAG 1168 -704 Vtri
FLAG 1488 -688 0
FLAG 1040 -672 0
FLAG 848 -688 Vref
FLAG 1376 -736 Vref
FLAG 1616 -720 Vsq
FLAG 1040 -736 Vsupply
FLAG 1488 -752 Vsupply
FLAG 1616 -1088 Vsupply
FLAG -96 -976 0
FLAG 144 -640 Vref
FLAG 256 -768 0
FLAG 256 -832 Vsupply
FLAG -112 -640 0
FLAG 176 80 Vsupply
FLAG 176 144 0
FLAG 400 -976 Visc
FLAG -208 96 Vtri
FLAG 320 -32 Vsupply
FLAG 384 112 Vpwm
FLAG 1152 -192 Vsupply
FLAG 912 16 Vpwm
FLAG 1152 464 0
FLAG -272 -784 Vin
FLAG -208 128 Visc
FLAG 3888 -784 Vamp
FLAG 320 1280 Vsupply
FLAG 160 1568 0
FLAG -176 1456 Vref
FLAG 3456 -784 Vhf
FLAG 496 1504 0
FLAG 2512 32 Vsupply
FLAG 2512 96 0
FLAG 2224 48 Vbias
FLAG 2656 -80 Vsupply
FLAG 2720 64 Vrx
FLAG 2224 80 Vamp
FLAG 3536 304 0
FLAG 3744 80 Vsupply
FLAG 3200 128 Vrx
FLAG 3744 144 0
FLAG 3872 112 Vout
FLAG -176 1536 0
FLAG 2336 -528 0
FLAG 2608 -816 0
FLAG 2608 -880 Vsupply
FLAG 2640 -752 Vbias
FLAG 2848 -1008 Vdet
SYMBOL voltage 176 1008 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V3
SYMATTR Value SINE({Vin_offset} {A} {f})
SYMBOL LED 1360 -112 R0
SYMATTR InstName D1
SYMATTR Value KA3529
SYMBOL cap 3376 -800 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C2
SYMATTR Value 27n
SYMBOL res 3440 -752 R0
SYMATTR InstName R2
SYMATTR Value 10k
SYMBOL res 3648 -1024 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R3
SYMATTR Value 33k
SYMBOL res 3408 -1024 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R4
SYMATTR Value 1k
SYMBOL OpAmps\\opamp2 3600 -864 R0
SYMATTR InstName U3
SYMATTR Value LM324
SYMBOL voltage -320 1008 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V4
SYMATTR Value {Vsupply}
SYMBOL res 928 -896 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R8
SYMATTR Value {R1}
SYMBOL cap 1072 -896 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C3
SYMATTR Value {C1}
SYMATTR SpiceLine Rser=10m
SYMBOL res 1328 -720 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R9
SYMATTR Value {R2}
SYMBOL res 1552 -608 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R10
SYMATTR Value {R3}
SYMBOL res 1632 -976 R180
WINDOW 0 36 76 Left 2
WINDOW 3 36 40 Left 2
SYMATTR InstName R11
SYMATTR Value 1k
SYMBOL res 96 -800 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R14
SYMATTR Value 68k
SYMBOL res 160 -656 R180
WINDOW 0 36 76 Left 2
WINDOW 3 36 40 Left 2
SYMATTR InstName R15
SYMATTR Value 33k
SYMBOL res 192 -960 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 0 56 VBottom 2
SYMATTR InstName R16
SYMATTR Value 33k
SYMBOL res -16 -960 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 0 56 VBottom 2
SYMATTR InstName R17
SYMATTR Value 68k
SYMBOL cap -176 -800 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C4
SYMATTR Value 1µ
SYMBOL res -128 -768 R0
SYMATTR InstName R18
SYMATTR Value 8.5k
SYMBOL res 240 240 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R19
SYMATTR Value 27k
SYMBOL res -32 112 R90
WINDOW 0 82 46 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R20
SYMATTR Value 1k
SYMBOL res 304 -16 R0
SYMATTR InstName R21
SYMATTR Value 1k
SYMBOL OpAmps\\opamp2 256 -864 R0
WINDOW 3 24 82 Left 2
SYMATTR Value LM358
SYMATTR InstName U5
SYMBOL OpAmps\\opamp2 1040 -768 R0
WINDOW 3 22 83 Left 2
SYMATTR Value LM358
SYMATTR InstName U6
SYMBOL OpAmps\\opamp2 1488 -784 R0
WINDOW 3 24 80 Left 2
SYMATTR Value LM393A
SYMATTR InstName U7
SYMBOL OpAmps\\opamp2 176 48 R0
WINDOW 3 22 81 Left 2
SYMATTR Value LM393A
SYMATTR InstName U8
SYMBOL npn 1088 -32 R0
SYMATTR InstName Q1
SYMATTR Value BC547B
SYMBOL res 896 -144 R0
SYMATTR InstName R22
SYMATTR Value 2.2k
SYMBOL res 896 208 R0
SYMATTR InstName R23
SYMATTR Value 1k
SYMBOL res 1136 208 R0
SYMATTR InstName R24
SYMATTR Value 1k
SYMBOL res 1360 304 R0
SYMATTR InstName R25
SYMATTR Value 27
SYMBOL npn 1312 48 R0
SYMATTR InstName Q2
SYMATTR Value BC639
SYMBOL res 1504 304 R0
SYMATTR InstName R28
SYMATTR Value 39
SYMBOL res 144 1296 R0
SYMATTR InstName R29
SYMATTR Value 2.2k
SYMBOL res 144 1440 R0
SYMATTR InstName R30
SYMATTR Value 2.2k
SYMBOL voltage 496 1408 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V1
SYMATTR Value 2.5
SYMBOL res 2640 -64 R0
SYMATTR InstName R5
SYMATTR Value 1k
SYMBOL res 2368 64 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R6
SYMATTR Value 1k
SYMBOL res 2576 208 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R7
SYMATTR Value 10k
SYMBOL OpAmps\\opamp2 2512 0 R0
WINDOW 3 22 81 Left 2
SYMATTR Value LM393A
SYMATTR InstName U4
SYMBOL res 3344 112 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R12
SYMATTR Value 100k
SYMBOL res 3504 112 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R13
SYMATTR Value 10k
SYMBOL cap 3520 192 R0
SYMATTR InstName C5
SYMATTR Value 820p
SYMBOL cap 3584 -48 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C6
SYMATTR Value 10n
SYMBOL OpAmps\\opamp2 3744 48 R0
SYMATTR InstName U1
SYMATTR Value LM324
SYMBOL voltage -176 1440 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V2
SYMATTR Value 2.35
SYMBOL bi 2176 -768 R0
WINDOW 3 -93 282 Left 2
SYMATTR Value I=9.5e-6*I(D1)+15e-8*white(1e8*time)
SYMATTR InstName I_P1
SYMBOL cap 2320 -768 R0
WINDOW 3 24 36 Left 2
SYMATTR Value 4.25p
SYMATTR InstName C_1
SYMBOL res 2480 -784 R0
WINDOW 3 36 68 Left 2
SYMATTR Value 16.6G
SYMATTR InstName R_leak1
SYMBOL cap 2672 -1120 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C1
SYMATTR Value 7.5p
SYMBOL res 2688 -1024 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R1
SYMATTR Value 100k
SYMBOL OpAmps\\opamp2 2608 -912 R0
SYMATTR InstName U2
SYMATTR Value LM324
TEXT 824 976 Left 2 !.tran 0 12m 6m startup
TEXT 824 1200 Left 2 !.param f=1k Vin_offset=3V A=1
TEXT 2080 -456 Left 1 ;If 100mm apart use:\n    I=9.5e-6*I(D1)+15e-9*white(1e8*time)\nIf 400mm apart use:\n    I=0.55e-6*I(D1)+15e-9*white(1e8*time)
TEXT -448 648 Left 7 ;Transmitter
TEXT 1912 648 Left 7 ;Receiver
TEXT 824 1488 Left 2 !.include LM393A.5_1
TEXT 824 1520 Left 2 !.include eee305.lib
TEXT 824 1232 Left 2 !.param C1=15n Vsupply=5 R1=1k R2=33k R3=82k
TEXT 976 -1248 Left 3 ;Triangle Waveform Generator
TEXT -96 -1248 Left 3 ;Input Signal Conditioner
TEXT 1096 -304 Left 3 ;LED Driver
TEXT -8 -304 Left 3 ;PWM Generator
TEXT -344 1152 Left 2 ;L78L05ACZ 5V DC\nlinear regulator
TEXT -344 1616 Left 2 ;2V reference \ngenerator circuit
TEXT -136 768 Left 3 ;Sources/References
TEXT -448 -1696 Left 5 ;ELECTENG 310 Assignment 2\nGroup 6\n \nThomas Cummings\nDemian Pillay\nAshley v.d. Merwe
TEXT 824 1008 Left 2 !.fourier {f} 100 V(vout)
TEXT -472 1784 Left 7 ;Set Up
TEXT 1064 768 Left 3 ;Spice Directives
TEXT 824 1424 Left 2 !.include "KA3529 LTSpice Model.txt"
TEXT 824 1456 Left 2 !.include "BC639 LTSpice Model.txt"
TEXT 832 1168 Left 2 ;Transmitter
TEXT 832 944 Left 2 ;Simulation Command
TEXT 832 1392 Left 2 ;File Includes
TEXT 2360 -1248 Left 3 ;Light Detector
TEXT 3328 -1248 Left 3 ;High-pass Filter/Amplification
TEXT 2344 -304 Left 3 ;PWM Regenerator
TEXT 3456 -304 Left 3 ;Low-pass Filter
TEXT 144 1624 Left 2 ;2.5V bias \ngenerator circuit
TEXT 160 1160 Left 2 ;Speed signal from Body Control Unit
TEXT 2176 -888 Left 2 ;Photo-diode
TEXT 2504 -1160 Left 2 ;Two 15pF Capacitors in series
LINE Normal 656 560 656 -1280
LINE Normal 656 560 656 560 2
LINE Normal 1744 -336 -448 -336
LINE Normal 3024 560 3024 -1280
LINE Normal 3024 560 3024 560 2
LINE Normal 1744 -336 -448 -336
LINE Normal 4112 -336 1920 -336
RECTANGLE Normal -448 -1280 1744 560
RECTANGLE Normal 1920 -1280 4112 560
RECTANGLE Normal -464 1696 640 736
RECTANGLE Normal 640 1696 1744 736
RECTANGLE Normal -448 -1280 1744 560
